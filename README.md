# Slow server simulator

This repo contains a very simple simulator for exploring the behavior of a slow
server in a simple distributed system.  For more information, see the
accompanying blog post.

The configuration of the system is currently hardcoded.  It consists of:

- a time limit (how long a period to simulate)
- a total level of client concurrency
- an array of server classes, each of which includes a count and
  latency-per-request for that server.

The hardcoded configuration runs a 10-minute simulation with 10,000 clients, 1
"slow" server that takes 1s per request, and 99 "fast" servers that take 1ms per
request.  Results (`server_0` is the "slow" server):

    $ node sim.js 
    server_0     5454078 requests (9090 rps)
    server_1     5465366 requests (9109 rps)
    server_2     5466457 requests (9111 rps)
    server_3     5466023 requests (9110 rps)
    server_4     5466697 requests (9111 rps)
    server_5     5469202 requests (9115 rps)
    server_6     5465585 requests (9109 rps)
    server_7     5466955 requests (9112 rps)
    server_8     5468618 requests (9114 rps)
    server_9     5467606 requests (9113 rps)
    server_10    5468337 requests (9114 rps)
    server_11    5467801 requests (9113 rps)
    server_12    5463477 requests (9106 rps)
    server_13    5466741 requests (9111 rps)
    server_14    5469712 requests (9116 rps)
    server_15    5468187 requests (9114 rps)
    server_16    5464500 requests (9108 rps)
    server_17    5471130 requests (9119 rps)
    server_18    5466578 requests (9111 rps)
    server_19    5469919 requests (9117 rps)
    server_20    5467630 requests (9113 rps)
    server_21    5468509 requests (9114 rps)
    server_22    5469364 requests (9116 rps)
    server_23    5467022 requests (9112 rps)
    server_24    5467645 requests (9113 rps)
    server_25    5465375 requests (9109 rps)
    server_26    5468442 requests (9114 rps)
    server_27    5468621 requests (9114 rps)
    server_28    5467887 requests (9113 rps)
    server_29    5469498 requests (9116 rps)
    server_30    5468521 requests (9114 rps)
    server_31    5469939 requests (9117 rps)
    server_32    5470376 requests (9117 rps)
    server_33    5466155 requests (9110 rps)
    server_34    5467462 requests (9112 rps)
    server_35    5469229 requests (9115 rps)
    server_36    5468891 requests (9115 rps)
    server_37    5466980 requests (9112 rps)
    server_38    5468124 requests (9114 rps)
    server_39    5469792 requests (9116 rps)
    server_40    5466376 requests (9111 rps)
    server_41    5467115 requests (9112 rps)
    server_42    5465258 requests (9109 rps)
    server_43    5470485 requests (9117 rps)
    server_44    5468983 requests (9115 rps)
    server_45    5468346 requests (9114 rps)
    server_46    5469429 requests (9116 rps)
    server_47    5466464 requests (9111 rps)
    server_48    5468599 requests (9114 rps)
    server_49    5471544 requests (9119 rps)
    server_50    5465744 requests (9110 rps)
    server_51    5467987 requests (9113 rps)
    server_52    5468302 requests (9114 rps)
    server_53    5468350 requests (9114 rps)
    server_54    5468863 requests (9115 rps)
    server_55    5466699 requests (9111 rps)
    server_56    5466053 requests (9110 rps)
    server_57    5472735 requests (9121 rps)
    server_58    5469123 requests (9115 rps)
    server_59    5471069 requests (9118 rps)
    server_60    5466466 requests (9111 rps)
    server_61    5467769 requests (9113 rps)
    server_62    5469517 requests (9116 rps)
    server_63    5469209 requests (9115 rps)
    server_64    5466775 requests (9111 rps)
    server_65    5468432 requests (9114 rps)
    server_66    5470970 requests (9118 rps)
    server_67    5465892 requests (9110 rps)
    server_68    5468032 requests (9113 rps)
    server_69    5466780 requests (9111 rps)
    server_70    5467518 requests (9113 rps)
    server_71    5469134 requests (9115 rps)
    server_72    5468242 requests (9114 rps)
    server_73    5468185 requests (9114 rps)
    server_74    5471710 requests (9120 rps)
    server_75    5467578 requests (9113 rps)
    server_76    5469520 requests (9116 rps)
    server_77    5465624 requests (9109 rps)
    server_78    5468948 requests (9115 rps)
    server_79    5470528 requests (9118 rps)
    server_80    5466457 requests (9111 rps)
    server_81    5470143 requests (9117 rps)
    server_82    5465697 requests (9109 rps)
    server_83    5470089 requests (9117 rps)
    server_84    5465605 requests (9109 rps)
    server_85    5466601 requests (9111 rps)
    server_86    5469091 requests (9115 rps)
    server_87    5472422 requests (9121 rps)
    server_88    5468446 requests (9114 rps)
    server_89    5469219 requests (9115 rps)
    server_90    5469389 requests (9116 rps)
    server_91    5468364 requests (9114 rps)
    server_92    5468914 requests (9115 rps)
    server_93    5469809 requests (9116 rps)
    server_94    5468961 requests (9115 rps)
    server_95    5469892 requests (9116 rps)
    server_96    5469875 requests (9116 rps)
    server_97    5469671 requests (9116 rps)
    server_98    5470056 requests (9117 rps)
    server_99    5473263 requests (9122 rps)
    overall:   546814748 requests (911357 rps, expect 9113 rps per server)

As a sanity check on the simulator, if we change the simulation time to 990ms,
`server_0` completes no requests (as expected), while other servers complete
many:

    $ node sim.js 
    server_0           0 requests (   0 rps)
    server_1       10307 requests (10411 rps)
    server_2       10174 requests (10277 rps)
    server_3       10062 requests (10164 rps)
    server_4       10029 requests (10130 rps)
    ...
    server_99       9865 requests (9965 rps)
    overall:      992268 requests (1002290 rps, expect 10022 rps per server)
